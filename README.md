# ProjectLogAn
Здесь представлен проект Log Analyzer (LogAn).

## Требования
Предполагается, что у вас имеется хост Ansible, а также хоть один целевой хост для установки сервиса с установленными пакетами docker и docker-compose.

## Установка
1. Произвести 'git clone' проекта на хост с настроенным Ansibe.
2. Запустить logan_playbook.yml (при необходимости изменить строку hosts: all).

## Особености работы
* При установке роли Ansible (logan) на целевом хосте будет создан каталог для размещения файлов сервиса (предустановка /opt/logan), скопирован файл docker-compose и основной Python-скрипт. После этого сервис будет запущен через docker-compose.
* Во время запуска сервиса docker-compose создаёт в своей основной папке директории Input и Output, через которые предполагается взаимодействие с сервисом.
* После запуска сервис каждую секунду просматривает папку Input на наличие файлов. Ожидаются лог-файлы с содержимым формата:
"*YYYY-MM-DD HH:MM:SS some_others_metrics LAG"*. Строки с иным форматом будут исключены из анализа.
* Параметры анализа установлены в основном скрипте. Их предустановленные значения:
  * порог задержки считающейся превышением нормы 5000 мс
  * критерии оценки: аварией считается ситуация когда в цепи из 5 строк лог-файла более 2 превышений порога задержки
* После окончания обработки её результаты будут располагаться в папке Output, в файле с исходным именем с приставкой "result_". Исходные файлы будут удалены из Input.
* Результаты содержат информацию об авариях:
  * время начала аварии
  * время логгирования первой записи об аварии
  * время окончания аварии
  * продолжительность аварии в секундах
  * количество строк файла, относящихся к аварии
  * максимальное значение задержки во время аварии
